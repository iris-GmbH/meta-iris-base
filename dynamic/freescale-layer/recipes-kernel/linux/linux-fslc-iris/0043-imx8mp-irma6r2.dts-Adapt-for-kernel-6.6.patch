From d05ff4472d0912a261f63c6ce8df00deeb9ed9b8 Mon Sep 17 00:00:00 2001
From: Erik Schumacher <erik.schumacher@iris-sensing.com>
Date: Wed, 12 Jun 2024 09:53:45 +0000
Subject: [PATCH] imx8mp-irma6r2.dts: Adapt for kernel 6.6

---
 .../boot/dts/freescale/imx8mp-irma6r2.dts     | 50 +++++++++----------
 1 file changed, 25 insertions(+), 25 deletions(-)

diff --git a/arch/arm64/boot/dts/freescale/imx8mp-irma6r2.dts b/arch/arm64/boot/dts/freescale/imx8mp-irma6r2.dts
index 55cb5c68772d..58584030b0ee 100644
--- a/arch/arm64/boot/dts/freescale/imx8mp-irma6r2.dts
+++ b/arch/arm64/boot/dts/freescale/imx8mp-irma6r2.dts
@@ -49,7 +49,7 @@ clk_serializer: serializer_clock {
 		#clock-cells = <0>;
 		clock-frequency = <23800000>;
 		clock-output-names = "serializer_clk";
-		pwms = <&pwm2 0 42>; /* 42ns - 23.8 MHz */
+		pwms = <&pwm2 0 42 0>; /* 42ns - 23.8 MHz */
 	};
 
 	gpio-keys {
@@ -213,31 +213,35 @@ tc358748_adapter: csi-bridge@e {
 		status = "okay";
 
 		clocks = <&clk_serializer>;
+		clock-names = "refclk";
+
 		default-input = <0>;
 		pinctrl-0 = <&pinctrl_csi0_rst_bridge>;
 		reset-gpios = <&gpio4 17 GPIO_ACTIVE_LOW>;
 
-		#address-cells = <1>;
-		#size-cells = <0>;
-
-		port@0 {
-			reg = <0>;
-			tc358748_parallel_in: endpoint {
-				bus-type = <5>;
-				bus-width = <12>;
-				hsync-active = <0>;
-				vsync-active = <0>;
-				field-even-active = <0>;
-				remote-endpoint = <&epc660_parallel_out>;
+		ports {
+			#address-cells = <1>;
+			#size-cells = <0>;
+
+			port@0 {
+				reg = <0>;
+				tc358748_parallel_in: endpoint {
+					bus-type = <5>;
+					bus-width = <12>;
+					hsync-active = <0>;
+					vsync-active = <0>;
+					field-even-active = <0>;
+					remote-endpoint = <&epc660_parallel_out>;
+				};
 			};
-		};
-		port@1 {
-			reg = <1>;
-			tc358748_mipi_out: endpoint {
-				data-lanes = <1 2>;
-				clock-noncontinuous;
-				link-frequencies = /bits/ 64 <216000000>;
-				remote-endpoint = <&mipi1_csi_in>;
+			port@1 {
+				reg = <1>;
+				tc358748_mipi_out: endpoint {
+					data-lanes = <1 2>;
+					clock-noncontinuous;
+					link-frequencies = /bits/ 64 <216000000>;
+					remote-endpoint = <&mipi1_csi_in>;
+				};
 			};
 		};
 	};
@@ -835,10 +839,6 @@ &isi_0 {
 	cap_device {
 		status = "okay";
 	};
-
-	m2m_device {
-		status = "okay";
-	};
 };
 
 &isi_1 {
-- 
2.46.0

